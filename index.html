<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boto Cor-de-Rosa</title>
    <style>
        :root {
            --tile: 32px;
            --scale: 2;
            --duration: 0.333s;
        }
        
        body {
            background-color: #fce7f3;
            margin: 0;
            height: 100vh;
            display: grid;
            place-items: center;
            overflow: hidden;
        }

        .pet-container {
            width: calc(var(--tile) * var(--scale));
            height: calc(var(--tile) * var(--scale));
            position: relative;
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .pet {
            width: var(--tile);
            height: var(--tile);
            image-rendering: pixelated;
            background-image: url('./public/sprites/boto.png');
            background-repeat: no-repeat;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) scale(var(--scale));
        }

        @keyframes sprite {
            from { background-position-x: 0; }
            to { background-position-x: calc(var(--frames, 4) * var(--tile) * -1); }
        }

        .pet[data-state] {
            animation: sprite var(--duration) steps(var(--frames, 4)) var(--loop, 1);
        }

        .pet[data-state="idle"] {
            --frames: 4;
            --loop: infinite;
            background-position-y: calc(var(--tile) * 0);
        }

        .pet[data-state="tap"] {
            --frames: 4;
            background-position-y: calc(var(--tile) * -1);
        }

        .pet[data-state="wave"] {
            --frames: 4;
            background-position-y: calc(var(--tile) * -2);
        }

        .pet[data-state="success"] {
            --frames: 4;
            background-position-y: calc(var(--tile) * -3);
        }

        .pet[data-state="error"] {
            --frames: 4;
            background-position-y: calc(var(--tile) * -4);
        }

        .pet[data-state="loading"] {
            --frames: 4;
            --loop: infinite;
            background-position-y: calc(var(--tile) * -5);
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>
<body>
    <div class="pet-container">
        <h1 class="sr-only">Boto Virtual</h1>
        <div class="pet" id="boto" data-state="idle" role="img" aria-label="Boto Cor-de-Rosa virtual interativo"></div>
    </div>

    <script>
        const boto = document.getElementById('boto');
        
        async function play(state) {
            if (boto.dataset.state === state) return;
            
            boto.dataset.state = state;
            
            if (state !== 'idle' && state !== 'loading') {
                await new Promise(resolve => {
                    boto.addEventListener('animationend', () => {
                        boto.dataset.state = 'idle';
                        resolve();
                    }, { once: true });
                });
            }
        }

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            const actions = {
                '1': 'tap',
                '2': 'wave',
                '3': 'success',
                '4': 'error',
                '5': 'loading',
                'Escape': 'idle'
            };

            if (actions[e.key]) {
                play(actions[e.key]);
            }
        });

        // Start with idle animation
        play('idle');
    </script>
</body>
</html>
